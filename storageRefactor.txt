Amplify Storage Refactor 


Storage Module:

The storage module currently exposes 4 APIs: get, put, remove and list objects to the Amplify customers. 
The configuration of Storage requires bucket name, region and optional attribute of level for interacting with Storage. 


Open Feature Requests

There are two main asks for Storage module to support resumable multi-part uploads and support for multiple buckets. 
1. https://github.com/aws/aws-amplify/issues/61 
2. https://github.com/aws/aws-amplify/issues/329 

Apart from these requests, the refactor also needs to take into consideration client-side encryption and make the Storage module a plug-in that can be used for any other cloud provider too. 


Storage APIs and Options Proposed: 

Instead of one storage object, we will have an array of Storage objects to support multiple buckets. 
The calls to storage component to configure or to any of its APIs would look like so : 
Storage.buckets[1].configure(options);
Storage.buckets[1].put(key, object, { encrypt: true, level: public}); 

Options for each bucket: 

1.	Bucket/? : string
2.	Region? : string
3.	Credentials? : string
4.	Level? : string
5.	ClientSideMasterKey? : string
6.	Encrypt? : bool



APIs: 

The API calls would remain the same for the 4 already defined APIs. 
The aws-sdk APIs to be used for the calls will be updated to use : createMultipartUpload, abortMultipartUpload and completeMultipartUpload for the Put API. This is needed to provide more control over the resuming/cancelling the upload for the customerâ€™s bucket. 

	
1.	In addition to the current APIs, we will add one more public API cancelPut to handle multipart uploads better. 
2.	Storage will also require private APIs for encrypting and decrypting client data. 
(? Should this be another module ?? )


